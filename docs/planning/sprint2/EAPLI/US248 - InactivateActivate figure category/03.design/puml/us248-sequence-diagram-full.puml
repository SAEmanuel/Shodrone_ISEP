@startuml
skinparam monochrome true
skinparam packageStyle rectangle
skinparam shadowing false

title UI Sequence Diagram (SSD) - Inactivate/Activate Figure Category

autonumber

actor "Show Designer" as SD
participant ":FigureCategoryAvailabilityUI" as UI
participant ":EditFigureCategoryController" as CTRL
participant "RepositoryProvider" as Provider
participant "FigureCategoryRepository" as Repo
participant "InMemoryFigureCategoryRepository" as InMemRepo
participant "FigureCategoryJPAImpl" as JpaRepo
participant "FigureCategory" as Category

activate SD
SD -> UI : request to change availability of category
activate UI

UI -> CTRL : getAllFigureCategories()
activate CTRL

CTRL -> Provider : figureCategoryRepository()
activate Provider
Provider --> CTRL : repository instance
deactivate Provider

alt Repository is InMemoryFigureCategoryRepository
    CTRL -> InMemRepo : findAll()
    activate InMemRepo
    InMemRepo --> CTRL : List<FigureCategory>
    deactivate InMemRepo
else Repository is FigureCategoryJPAImpl
    CTRL -> JpaRepo : findAll()
    activate JpaRepo
    JpaRepo --> CTRL : List<FigureCategory>
    deactivate JpaRepo
end

CTRL --> UI : Optional<List<FigureCategory>>
deactivate CTRL

UI -> SD : show categories to choose from

SD -> UI : selects category
UI -> CTRL : changeStatus(selectedCategory)
activate CTRL

CTRL -> Provider : figureCategoryRepository()
activate Provider
Provider --> CTRL : repository instance
deactivate Provider

alt Repository is InMemoryFigureCategoryRepository
    CTRL -> InMemRepo : changeStatus(category)
    activate InMemRepo
    InMemRepo -> Category** : toggleState(), updateTime(), setUpdatedBy()
    InMemRepo --> CTRL : Optional<FigureCategory>
    deactivate InMemRepo
    deactivate Category
else Repository is FigureCategoryJPAImpl
    CTRL -> JpaRepo : changeStatus(category)
    activate JpaRepo
    JpaRepo -> JpaRepo : entityManager().find(category.id)
    JpaRepo -> Category** : toggleState(), updateTime(), setUpdatedBy()
    deactivate Category
    JpaRepo --> CTRL : Optional<FigureCategory>
    deactivate JpaRepo
end

CTRL --> UI : Optional<FigureCategory>
deactivate CTRL

alt Success
    UI -> SD : Success message
else Failure
    UI -> SD : Error message
end

deactivate UI
deactivate SD
@enduml