@startuml
skinparam monochrome true
skinparam packageStyle rectangle
skinparam shadowing false

title UI Sequence Diagram (SSD) - Add Video to Show Proposal (US315)

actor "User" as user
participant ":AddVideoOfSimulationToTheProposalUI" as UI
participant ":AddVideoOfSimulationToTheProposalController" as Controller
participant ":ShowProposalRepository" as Repository

activate user

user -> UI : launch Add Video to Show Proposal UI
activate UI

UI -> Drone3DSimulation : loadDroneDataFromCustomFormat(fileName)
activate Drone3DSimulation
Drone3DSimulation --> UI : drone data loaded
deactivate Drone3DSimulation

UI -> javafx.Application : launch Drone3DSimulation app
activate javafx.Application
javafx.Application --> UI : app launched
deactivate javafx.Application

UI -> UI : read video file "drone_<fileName>.mov"
UI -> Controller : getAllProposals()
activate Controller

Controller -> Repository : getAllProposals()
activate Repository

Repository --> Controller : Optional<List<ShowProposal>>
deactivate Repository

Controller --> UI : List<ShowProposal>
deactivate Controller

alt listOfProposals not empty

    UI -> UI : show proposals and prompt selection
    UI -> UI : select proposal index

    UI -> Controller : addVideoToShowProposal(selectedProposal, video)
    activate Controller

    Controller -> selectedProposal : editVideo(video)
    Controller -> Repository : updateInStoreProposal(showProposal)
    activate Repository

    Repository --> Controller : Optional<ShowProposal>
    deactivate Repository

    Controller --> UI : Optional<ShowProposal>
    deactivate Controller

    alt result present
        UI -> user : printSuccessMessage("Video added successfully to proposal!")
    else result empty
        UI -> user : printFailMessage("Something went wrong saving the Show Proposal!")
    end

else list empty or null
    UI -> user : printFailMessage("No Show Proposal")
end

deactivate UI
deactivate user

@enduml
