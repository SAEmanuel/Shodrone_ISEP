@startuml
skinparam monochrome true
skinparam packageStyle rectangle
skinparam shadowing false

title System Sequence Diagram (SSD) - Add Drones to Inventory

autonumber

actor "Drone Tech" as DT
participant ":System" as System

activate DT

DT -> System: requestListDroneModels()
activate System
System --> DT: droneModelsList
deactivate System

alt droneModelsList is empty
    DT -> System: receiveError("No drone models in the system yet...")
    deactivate System
    deactivate DT
else
    DT -> System: selectAddMethod()
    activate System
    System --> DT: addMethodOption
    deactivate System

    alt option is "Create a new Drone"
        DT -> System: selectDroneModel()
        activate System
        System --> DT: chosenModel
        deactivate System

        DT -> System: provideSerialNumber()
        activate System
        System -> System: validateSerialNumber()
        System -> System: createNewDrone(chosenModel, serialNumber)
        System -> System: saveDrone()
        alt save failed (duplicate serialNumber)
            System --> DT: errorMessage("A Drone with that Serial Number already exists in the system!")
        else save succeeded
            System --> DT: successMessage("Drone added successfully!")
        end
        deactivate System

    else option is "Add an existing Drone"
        DT -> System: requestAllDrones()
        activate System
        System --> DT: dronesList
        deactivate System

        alt dronesList is empty
            DT -> System: receiveError("No drones in the system yet...")
            deactivate System
            deactivate DT
        else
            DT -> System: provideSerialNumber()
            activate System
            System -> System: fetchDroneBySerialNumber(serialNumber)
            alt drone not found
                System --> DT: errorMessage("No drone with that Serial Number found in the system!")
                deactivate System
            else drone found
                System -> System: checkDroneStatus()
                alt drone status is AVAILABLE
                    System --> DT: errorMessage("This drone is already in the inventory")
                    deactivate System
                else
                    System --> DT: showDroneDetails()
                    activate System
                    DT -> System: confirmSelection()
                    System -> System: addExistingDrone()
                    System -> System: saveExistingDrone()
                    alt save failed
                        System --> DT: errorMessage("A Drone with that Serial Number already exists in the system!")
                    else save succeeded
                        System --> DT: successMessage("Drone added successfully!")
                    end
                    deactivate System
                end
            end
            deactivate System
        end
    end
end

deactivate DT

@enduml