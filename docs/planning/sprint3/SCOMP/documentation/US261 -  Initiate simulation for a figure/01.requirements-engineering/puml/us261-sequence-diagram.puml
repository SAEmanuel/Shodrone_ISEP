@startuml
skinparam monochrome true
skinparam packageStyle rectangle
skinparam shadowing false

title System Sequence Diagram (SSD) – US261 Initiate Simulation for a Figure

autonumber

actor "Drone Operator" as Operator
participant ":System" as System

activate Operator

Operator -> System: start simulation (script, tolerance)
activate System

System -> System: read environment + script file
System -> System: create pipes, fork drone processes
System -> System: send environment data to drones

loop for each timestamp (tick)
    System -> System: receive positions from drones
    System -> System: update timeline
    System -> System: detect collisions

    alt too many collisions
        System --> Operator: ⚠️ Alert - max collisions exceeded
        System -> System: send SIGUSR1 to all drones
        break
    else normal update
        System --> Operator: updated drone positions
    end alt
end loop

System -> System: wait for drone exits
System -> System: generate final report
System --> Operator: report ready

deactivate System
deactivate Operator

note right
Updated from C function `run_simulation()`\n
- One drone process per drone\n
- Communication via pipes\n
- Collisions trigger alerts and termination\n
- Simulation generates a text report
end note

@enduml
